<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
<meta name="viewport" content="user-scalable=no, width=device-width"  />
<meta name="apple-mobile-web-app-capable" content="yes" />

  <title>vitrum/node_123 @ GitHub</title>

  <style type="text/css">
    body {
      margin-top: 1.0em;
      background-color: #222;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #ffffff;
      width:100%;
      min-width:320px; max-width:480px;
      font-size:12px;
    }
  
    .btn { 
      float:left;
      background:-webkit-gradient(linear,left top,left bottom,from(#959595),to(#efefef));
      background:-moz-linear-gradient(center bottom,#959595,#efefef);
      border-radius: 10px 10px 10px 10px;
      line-height: 15px;
      height: 40px;
      margin: 4px 0 0 4px;
      padding: 6px;
      text-align: center;
      width: 90%;
    }
    .btn_red {
      background:-webkit-gradient(linear,left top,left bottom,from(#ff9595),to(#ffefef));
      background:-moz-linear-gradient(center bottom,#ff9595,#ffefef);
    }
    .btn_small {
      width:100px;
    }
    .log {
      width:90%;
      height:200px;
      overflow: auto;
      font-size:10px;
    }
  </style>
</head>

<body>
  <div id="info" class="log"></div>
  <div class="menu">
    <button id="btnClen" class="btn btn_red btn_small" >Clearn</button>
    <button id="btnSave" class="btn btn_small" >Save</button>
    <button id="btnLoad" class="btn btn_small" >Load</button>
    <button id="btnInit" class="btn" >Find my location</button>
  </div> 
  <div id="container"></div>

<script>
  /*geolocation  */
  var touchTime = 1 ;
  var geolocationJson = '';
  
        jQuery(window).ready(function(){  
            jQuery("#btnInit").click(initiate_geolocation); 
            
            jQuery("#btnClen").click(clearn_log); 
            
            jQuery("#btnSave").click(save_log); 
            
            jQuery("#btnLoad").click(load_log); 
             
        });  
  
        function initiate_geolocation() {  
            navigator.geolocation.getCurrentPosition(handle_geolocation_query,errorCallback);  
        }  
        
        function errorCallback(error) {
          // Update a div element with error.message.
          var text = "touchTime:" + touchTime + "<br/>error.message: "  + error.message + "<br/>" ;;
          jQuery("#info").prepend(text); 
          
        }
        
        function handle_geolocation_query(position){  
             var text =  "touchTime:" + touchTime + "<br/>Latitude: "  + position.coords.latitude  + "<br/>" +  
               "Longitude: " + position.coords.longitude + "<br/>" +  
               "Accuracy: "  + position.coords.accuracy  + "m<br/>" +  
               "Time: " + new Date(position.timestamp)+ "<br/><br/>" ;  
            jQuery("#info").prepend(text); 
            touchTime = touchTime + 1 ;
            var image_url = "http://maps.google.com/maps/api/staticmap?sensor=false&center=" + position.coords.latitude + "," +  
                    position.coords.longitude + "&zoom=16&size=300x400&markers=color:blue|label:S|" +  
                    position.coords.latitude + ',' + position.coords.longitude;  
  
            jQuery("#map").remove();  
            jQuery(document.body).append(  
              jQuery(document.createElement("img")).attr("src", image_url).attr('id','map')  
            );  
            
             var map = new BMap.Map("container");
             var point = new BMap.Point(position.coords.longitude, position.coords.latitude);
             map.centerAndZoom(point,16);
             
        }  
        
        function clearn_log() {  
            var text = "";
            jQuery("#info").html(text);
            touchTime = 1 ;
            
        }  
        function save_log() {  
            var text = "";
            geolocationJson = jQuery("#info").html();
            jQuery("#info").html(text);
            
        }  
        function load_log() {  
            var text = "";
            jQuery("#info").html(text);
            jQuery("#info").html(geolocationJson);
            
        }  
 

    


</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>  
<script type="text/javascript" src="http://api.map.baidu.com/api?v=1.2"></script>
</body>
</html>
